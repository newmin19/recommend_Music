(function(i,d){var e=function(){this.appkey="";this.login_form=null;this.client_id="";this.response_type="token";this._access_token=this.redirect_uri=this.scope="";this._access_token_start=14;this._access_token_end=50;this._access_token_time=null;this._access_token_time_limit=43195;this._loginStatus=false;this._checkAccessToken()};e.prototype={versionNumber:"1.0.0",SUCCESS_INIT:100,SUCCESS_LOGIN:101,SUCCESS_LOGOUT:102,SUCCESS_API:200,ERROR_INIT:-100,ERROR_LOGIN:-101,ERROR_LOGOUT:-102,ERROR_PARAMETER_MISSING:-201,
init:function(a){if(this.login_form===null){if(a)for(var b in a)this[b]=a[b];this.login_form=document.createElement("form");this.login_form.action="https://oneid.skplanetx.com/oauth/authorize/";this.login_form.method="get";var f=this;jQuery.each(["client_id","response_type","scope","redirect_uri"],function(a,b){var c=document.createElement("input"),g=document.createAttribute("type"),h=document.createAttribute("name"),j=document.createAttribute("value");g.value="hidden";h.value=b;j.value=f[b];c.setAttributeNode(g);
c.setAttributeNode(h);c.setAttributeNode(j);f.login_form.appendChild(c)});return this.SUCCESS_INIT}else return this.ERROR_INIT},login:function(){return this.login_form!==null?(this.login_form.submit(),this.SUCCESS_LOGIN):this.ERROR_LOGIN},logout:function(){i.ajax({beforeSend:function(a){a.setRequestHeader("appKey",this._getAppkey())},type:"get",url:"https://oneid.skplanetx.com/oauth/expireToken",data:{client_id:this.client_id,token:this._getAccessToken()},dataType:"jsonp",context:this,callback:"this.logoutCallback",
success:function(){this._clearToken();return this.SUCCESS_LOGOUT},error:function(a){if(a.status=="200")return this._clearToken(),this.SUCCESS_LOGOUT;a.status=="0"?alert("error 0: Network Problem"):a.status=="401"?(alert("error 401: Unauthorized"),location.href="https://developers.skplanetx.com/login/"):a.status=="403"?alert("error 403: Forbidden"):a.status=="404"?alert("error 404: Not Found"):a.status=="412"?alert("error 412: Precondition Failed "):a.status=="500"?alert("error 500: Internal Server Error"):
alert("error "+a.status);return this.ERROR_LOGOUT}})},getLoginStatus:function(){return this._loginStatus},logoutCallback:function(){},_setAppkey:function(a){this.appkey=a},_getAppkey:function(){return this.appkey},_saveToken:function(a){this._access_token_time=(new Date).getTime()/1E3;localStorage?(localStorage.setItem("token",a),localStorage.setItem("tokentime",this._access_token_time)):(document.cookie+="token="+a+";",document.cookie+="tokentime="+this._access_token_time+";")},_loadToken:function(){if(localStorage)this._access_token=
localStorage.getItem("token"),this._access_token_time=localStorage.getItem("tokentime");else{var a=document.cookie.split(";"),b;for(b in a)if(a[b].match("token="))this._access_token=a[b].substr(a[b].indexOf("=")+1);else if(a[b].match("tokentime="))this._access_token_time=a[b].substr(a[b].indexOf("=")+1)}current_time=(new Date).getTime()/1E3;if(!this._access_token||!this._access_token_time||this._access_token_time_limit-(current_time-this._access_token_time)<0)this._clearToken(),this._loginStatus=
false;else if(this._access_token&&this._access_token_time)this._loginStatus=true},_clearToken:function(){localStorage?(localStorage.removeItem("token"),localStorage.removeItem("tokentime")):this._saveToken("");this._access_token_time=this._access_token=""},_checkAccessToken:function(){this._loadToken();if(d.location.hash&&d.location.hash.substring(1).match(/^access_token/)!==null)this._access_token=d.location.hash.slice(this._access_token_start,this._access_token_end),this._saveToken(this._access_token),
this._loginStatus=true},_getAccessToken:function(){return this._access_token},api:function(a,b,f,d,e,c,g){if(!a||!b||!f||!d||!e)return this.ERROR_PARAMETER_MISSING;var h=this,a={type:a,url:b,dataType:f,data:d,success:e,error:c};if(!c)a.error=function(a){a.status=="0"?alert("jqXHR.status 0: Network Problem"):a.status=="401"?alert("jqXHR.status 401: Unauthorized"):a.status=="403"?alert("jqXHR.status 403: Forbidden"):a.status=="404"?alert("jqXHR.status 404: Not Found"):a.status=="412"?alert("jqXHR.status 412: Precondition Failed "):
a.status=="500"?alert("jqXHR.status 500: Internal Server Error "):alert("jqXHR.status "+a.status)};c={beforeSend:function(a){a.setRequestHeader("appKey",h._getAppkey())},data:{access_token:h._getAccessToken(),version:1},cache:false};i.extend(true,a,c);g&&i.extend(true,a,g);i.ajax(a);return this.SUCCESS_API}};d.PlanetX=new e})(jQuery,window);
